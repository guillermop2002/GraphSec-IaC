{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/sarif-2.1/schema/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.488", "informationUri": "https://checkov.io", "rules": [{"id": "CKV2_AWS_62", "name": "Ensure S3 buckets should have event notifications enabled", "shortDescription": {"text": "Ensure S3 buckets should have event notifications enabled"}, "fullDescription": {"text": "Ensure S3 buckets should have event notifications enabled"}, "help": {"text": "Ensure S3 buckets should have event notifications enabled\nResource: aws_s3_bucket.my_test_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62"}, {"id": "CKV2_AWS_6", "name": "Ensure that S3 bucket has a Public Access block", "shortDescription": {"text": "Ensure that S3 bucket has a Public Access block"}, "fullDescription": {"text": "Ensure that S3 bucket has a Public Access block"}, "help": {"text": "Ensure that S3 bucket has a Public Access block\nResource: aws_s3_bucket.my_test_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached"}, {"id": "CKV_AWS_21", "name": "Ensure all data stored in the S3 bucket have versioning enabled", "shortDescription": {"text": "Ensure all data stored in the S3 bucket have versioning enabled"}, "fullDescription": {"text": "Ensure all data stored in the S3 bucket have versioning enabled"}, "help": {"text": "Ensure all data stored in the S3 bucket have versioning enabled\nResource: aws_s3_bucket.my_test_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning"}, {"id": "CKV_AWS_20", "name": "S3 Bucket has an ACL defined which allows public READ access.", "shortDescription": {"text": "S3 Bucket has an ACL defined which allows public READ access."}, "fullDescription": {"text": "S3 Bucket has an ACL defined which allows public READ access."}, "help": {"text": "S3 Bucket has an ACL defined which allows public READ access.\nResource: aws_s3_bucket.my_test_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone"}, {"id": "CKV2_AWS_61", "name": "Ensure that an S3 bucket has a lifecycle configuration", "shortDescription": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "fullDescription": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "help": {"text": "Ensure that an S3 bucket has a lifecycle configuration\nResource: aws_s3_bucket.my_test_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61"}, {"id": "CKV_AWS_144", "name": "Ensure that S3 bucket has cross-region replication enabled", "shortDescription": {"text": "Ensure that S3 bucket has cross-region replication enabled"}, "fullDescription": {"text": "Ensure that S3 bucket has cross-region replication enabled"}, "help": {"text": "Ensure that S3 bucket has cross-region replication enabled\nResource: aws_s3_bucket.my_test_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled"}, {"id": "CKV_AWS_145", "name": "Ensure that S3 buckets are encrypted with KMS by default", "shortDescription": {"text": "Ensure that S3 buckets are encrypted with KMS by default"}, "fullDescription": {"text": "Ensure that S3 buckets are encrypted with KMS by default"}, "help": {"text": "Ensure that S3 buckets are encrypted with KMS by default\nResource: aws_s3_bucket.my_test_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV2_AWS_62", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure S3 buckets should have event notifications enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "test_infra/main.tf"}, "region": {"startLine": 13, "endLine": 16, "snippet": {"text": "resource \"aws_s3_bucket\" \"my_test_bucket\" {\n  bucket = \"mi-cubo-de-prueba-tfg-12345\"\n  acl    = \"public-read\"  # <-- VULNERABILIDAD DELIBERADA para pruebas\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_6", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 bucket has a Public Access block"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "test_infra/main.tf"}, "region": {"startLine": 13, "endLine": 16, "snippet": {"text": "resource \"aws_s3_bucket\" \"my_test_bucket\" {\n  bucket = \"mi-cubo-de-prueba-tfg-12345\"\n  acl    = \"public-read\"  # <-- VULNERABILIDAD DELIBERADA para pruebas\n}\n"}}}}]}, {"ruleId": "CKV_AWS_21", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure all data stored in the S3 bucket have versioning enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "test_infra/main.tf"}, "region": {"startLine": 13, "endLine": 16, "snippet": {"text": "resource \"aws_s3_bucket\" \"my_test_bucket\" {\n  bucket = \"mi-cubo-de-prueba-tfg-12345\"\n  acl    = \"public-read\"  # <-- VULNERABILIDAD DELIBERADA para pruebas\n}\n"}}}}]}, {"ruleId": "CKV_AWS_20", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "S3 Bucket has an ACL defined which allows public READ access."}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "test_infra/main.tf"}, "region": {"startLine": 13, "endLine": 16, "snippet": {"text": "resource \"aws_s3_bucket\" \"my_test_bucket\" {\n  bucket = \"mi-cubo-de-prueba-tfg-12345\"\n  acl    = \"public-read\"  # <-- VULNERABILIDAD DELIBERADA para pruebas\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_61", "ruleIndex": 4, "level": "error", "attachments": [], "message": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "test_infra/main.tf"}, "region": {"startLine": 13, "endLine": 16, "snippet": {"text": "resource \"aws_s3_bucket\" \"my_test_bucket\" {\n  bucket = \"mi-cubo-de-prueba-tfg-12345\"\n  acl    = \"public-read\"  # <-- VULNERABILIDAD DELIBERADA para pruebas\n}\n"}}}}]}, {"ruleId": "CKV_AWS_144", "ruleIndex": 5, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 bucket has cross-region replication enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "test_infra/main.tf"}, "region": {"startLine": 13, "endLine": 16, "snippet": {"text": "resource \"aws_s3_bucket\" \"my_test_bucket\" {\n  bucket = \"mi-cubo-de-prueba-tfg-12345\"\n  acl    = \"public-read\"  # <-- VULNERABILIDAD DELIBERADA para pruebas\n}\n"}}}}]}, {"ruleId": "CKV_AWS_145", "ruleIndex": 6, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 buckets are encrypted with KMS by default"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "test_infra/main.tf"}, "region": {"startLine": 13, "endLine": 16, "snippet": {"text": "resource \"aws_s3_bucket\" \"my_test_bucket\" {\n  bucket = \"mi-cubo-de-prueba-tfg-12345\"\n  acl    = \"public-read\"  # <-- VULNERABILIDAD DELIBERADA para pruebas\n}\n"}}}}]}]}]}