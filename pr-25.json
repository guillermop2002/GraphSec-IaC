{
    "nodes": [
        {
            "id": "aws_s3_bucket.my_test_bucket",
            "simple_name": "aws_s3_bucket.my_test_bucket",
            "label": "aws_s3_bucket.my_test_bucket",
            "type": "aws_s3_bucket",
            "file": "/home/runner/work/GraphSec-IaC/GraphSec-IaC/test_infra/main.tf",
            "start_line": 13,
            "end_line": 16,
            "security_issues": [
                {
                    "cfi": "25fa386dfe2e3cf155663ac54890a606ff7d71edc6bf43751d48acc9d73742ea",
                    "rule_id": "AVD-AWS-0086",
                    "normalized_cis": "CIS-AWS-2.1.5-ACL",
                    "resource_id": "aws_s3_bucket.my_test_bucket",
                    "message": "Artifact: main.tf\nType: terraform\nVulnerability AVD-AWS-0086\nSeverity: HIGH\nMessage: No public access block so not blocking public acls\nLink: [AVD-AWS-0086](https://avd.aquasec.com/misconfig/avd-aws-0086)",
                    "level": "error",
                    "file_path": "main.tf",
                    "start_line": 13,
                    "tool_name": "Trivy",
                    "sources": [
                        "Trivy"
                    ],
                    "correlation_layer": 1
                },
                {
                    "cfi": "4d099a232e9cff3e7d4fd15b66975ceda08784c2d75ce803a6ad444ac69bae49",
                    "rule_id": "AVD-AWS-0087",
                    "normalized_cis": "AVD-AWS-0087",
                    "resource_id": "aws_s3_bucket.my_test_bucket",
                    "message": "Artifact: main.tf\nType: terraform\nVulnerability AVD-AWS-0087\nSeverity: HIGH\nMessage: No public access block so not blocking public policies\nLink: [AVD-AWS-0087](https://avd.aquasec.com/misconfig/avd-aws-0087)",
                    "level": "error",
                    "file_path": "main.tf",
                    "start_line": 13,
                    "tool_name": "Trivy",
                    "sources": [
                        "Trivy"
                    ],
                    "correlation_layer": 1
                },
                {
                    "cfi": "d4eaec3a4dcff86b64645d232ce5b33a08d9da8e06334eb2d7796fe69622803c",
                    "rule_id": "AVD-AWS-0088",
                    "normalized_cis": "CIS-AWS-2.1.1",
                    "resource_id": "aws_s3_bucket.my_test_bucket",
                    "message": "Artifact: main.tf\nType: terraform\nVulnerability AVD-AWS-0088\nSeverity: HIGH\nMessage: Bucket does not have encryption enabled\nLink: [AVD-AWS-0088](https://avd.aquasec.com/misconfig/avd-aws-0088)",
                    "level": "error",
                    "file_path": "main.tf",
                    "start_line": 13,
                    "tool_name": "Trivy",
                    "sources": [
                        "Trivy"
                    ],
                    "correlation_layer": 1
                },
                {
                    "cfi": "8bb9b0a2807702ab673801924e8c8bc3c6c67cbba664bfa606d286b13563f2db",
                    "rule_id": "AVD-AWS-0090",
                    "normalized_cis": "CIS-AWS-2.1.6",
                    "resource_id": "aws_s3_bucket.my_test_bucket",
                    "message": "Artifact: main.tf\nType: terraform\nVulnerability AVD-AWS-0090\nSeverity: MEDIUM\nMessage: Bucket does not have versioning enabled\nLink: [AVD-AWS-0090](https://avd.aquasec.com/misconfig/avd-aws-0090)",
                    "level": "warning",
                    "file_path": "main.tf",
                    "start_line": 13,
                    "tool_name": "Trivy",
                    "sources": [
                        "Trivy"
                    ],
                    "correlation_layer": 1
                },
                {
                    "cfi": "7051b52195b2c97c75a07617715605acd9df0d62f92e7ea8319fcd6d21989eb7",
                    "rule_id": "AVD-AWS-0091",
                    "normalized_cis": "AVD-AWS-0091",
                    "resource_id": "aws_s3_bucket.my_test_bucket",
                    "message": "Artifact: main.tf\nType: terraform\nVulnerability AVD-AWS-0091\nSeverity: HIGH\nMessage: No public access block so not blocking public acls\nLink: [AVD-AWS-0091](https://avd.aquasec.com/misconfig/avd-aws-0091)",
                    "level": "error",
                    "file_path": "main.tf",
                    "start_line": 13,
                    "tool_name": "Trivy",
                    "sources": [
                        "Trivy"
                    ],
                    "correlation_layer": 1
                },
                {
                    "cfi": "b40d09430c2c344dc97ed8edf1c940005670053e3260b33e98a0bb904fd267e2",
                    "rule_id": "AVD-AWS-0092",
                    "normalized_cis": "CIS-AWS-2.1.5",
                    "resource_id": "aws_s3_bucket.my_test_bucket",
                    "message": "Artifact: main.tf\nType: terraform\nVulnerability AVD-AWS-0092\nSeverity: HIGH\nMessage: Bucket has a public ACL: \"public-read\"\nLink: [AVD-AWS-0092](https://avd.aquasec.com/misconfig/avd-aws-0092)",
                    "level": "error",
                    "file_path": "main.tf",
                    "start_line": 15,
                    "tool_name": "Trivy",
                    "sources": [
                        "Trivy"
                    ],
                    "correlation_layer": 1
                },
                {
                    "cfi": "bdceeda394738dfb80325c6ac193b1aefc5f3dcf06903c513ae6a863b5de56b3",
                    "rule_id": "AVD-AWS-0093",
                    "normalized_cis": "AVD-AWS-0093",
                    "resource_id": "aws_s3_bucket.my_test_bucket",
                    "message": "Artifact: main.tf\nType: terraform\nVulnerability AVD-AWS-0093\nSeverity: HIGH\nMessage: No public access block so not restricting public buckets\nLink: [AVD-AWS-0093](https://avd.aquasec.com/misconfig/avd-aws-0093)",
                    "level": "error",
                    "file_path": "main.tf",
                    "start_line": 13,
                    "tool_name": "Trivy",
                    "sources": [
                        "Trivy"
                    ],
                    "correlation_layer": 1
                },
                {
                    "cfi": "82a3967028136d7cb5363703ca79e523703f25a78881abf93af6210001dd43c0",
                    "rule_id": "AVD-AWS-0094",
                    "normalized_cis": "CIS-AWS-2.2.1",
                    "resource_id": "aws_s3_bucket.my_test_bucket",
                    "message": "Artifact: main.tf\nType: terraform\nVulnerability AVD-AWS-0094\nSeverity: LOW\nMessage: Bucket does not have a corresponding public access block.\nLink: [AVD-AWS-0094](https://avd.aquasec.com/misconfig/avd-aws-0094)",
                    "level": "note",
                    "file_path": "main.tf",
                    "start_line": 13,
                    "tool_name": "Trivy",
                    "sources": [
                        "Trivy"
                    ],
                    "correlation_layer": 1
                },
                {
                    "cfi": "74ba420751d8b02bceff041e471745f33c16591cbaa3b4006e3003298da700aa",
                    "rule_id": "AVD-AWS-0132",
                    "normalized_cis": "CIS-AWS-4.3",
                    "resource_id": "aws_s3_bucket.my_test_bucket",
                    "message": "Artifact: main.tf\nType: terraform\nVulnerability AVD-AWS-0132\nSeverity: HIGH\nMessage: Bucket does not encrypt data with a customer managed key.\nLink: [AVD-AWS-0132](https://avd.aquasec.com/misconfig/avd-aws-0132)",
                    "level": "error",
                    "file_path": "main.tf",
                    "start_line": 13,
                    "tool_name": "Trivy",
                    "sources": [
                        "Trivy"
                    ],
                    "correlation_layer": 1
                }
            ]
        },
        {
            "id": "aws_s3_bucket_logging.logging_config",
            "simple_name": "aws_s3_bucket_logging.logging_config",
            "label": "aws_s3_bucket_logging.logging_config",
            "type": "aws_s3_bucket_logging",
            "file": "/home/runner/work/GraphSec-IaC/GraphSec-IaC/test_infra/main.tf",
            "start_line": 18,
            "end_line": 23,
            "security_issues": []
        }
    ],
    "edges": [
        {
            "from": "aws_s3_bucket_logging.logging_config",
            "to": "aws_s3_bucket.my_test_bucket",
            "source": "aws_s3_bucket_logging.logging_config",
            "target": "aws_s3_bucket.my_test_bucket"
        }
    ],
    "unassigned_findings": [],
    "correlation_metadata": {
        "assigned_findings": 9,
        "unassigned_findings_count": 0,
        "nodes_with_issues_count": 1,
        "total_unique_findings": 9,
        "layer_stats": {
            "1": 9,
            "2": 0,
            "3": 0,
            "0": 0
        }
    },
    "api_metadata": {
        "status": "success",
        "message": "Pipeline completado exitosamente para proyecto 'test_infra_pr_25'",
        "project_name": "test_infra_pr_25",
        "project_directory": "./test_infra",
        "scanners_used": 1,
        "checkov_success": false,
        "trivy_success": true,
        "total_findings_original": 9,
        "total_findings_unique": 9,
        "duplicates_removed": 0,
        "deduplication_method": "CFI_CIS+SARIF_FP",
        "total_nodes": 2,
        "total_edges": 1,
        "correlation_metadata": {
            "assigned_findings": 9,
            "unassigned_findings_count": 0,
            "nodes_with_issues_count": 1,
            "total_unique_findings": 9,
            "layer_stats": {
                "1": 9,
                "2": 0,
                "3": 0,
                "0": 0
            }
        },
        "unassigned_findings_count": 0
    }
}